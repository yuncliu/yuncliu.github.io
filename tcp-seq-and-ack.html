<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>TCP Seq and Ack - Yuncheng Liu's Blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://yuncliu.github.io/tcp-seq-and-ack.html">

        <meta name="author" content="yuncliu" />
        <meta name="keywords" content="network" />
        <meta name="description" content="Sequence and Acknowlegement number is very import in TCP protocol. They are used to detect if the packet is out of order or if there are any missing pakcets. The Seq in the SYN packet is called ISN(Initial Sequence Number) Wireshark will calculate relative sequence nuber = real Seq - ISN ..." />

        <meta property="og:site_name" content="Yuncheng Liu's Blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="TCP Seq and Ack"/>
        <meta property="og:url" content="https://yuncliu.github.io/tcp-seq-and-ack.html"/>
        <meta property="og:description" content="Sequence and Acknowlegement number is very import in TCP protocol. They are used to detect if the packet is out of order or if there are any missing pakcets. The Seq in the SYN packet is called ISN(Initial Sequence Number) Wireshark will calculate relative sequence nuber = real Seq - ISN ..."/>
        <meta property="article:published_time" content="2015-09-23" />
            <meta property="article:section" content="network" />
            <meta property="article:tag" content="network" />
            <meta property="article:author" content="yuncliu" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://yuncliu.github.io/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://yuncliu.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://yuncliu.github.io/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://yuncliu.github.io/theme/css/style.css" type="text/css"/>

        <link href="https://yuncliu.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Yuncheng Liu's Blog ATOM Feed"/>



        <link href="https://yuncliu.github.io/feeds/network.atom.xml" type="application/atom+xml" rel="alternate"
              title="Yuncheng Liu's Blog network ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://yuncliu.github.io/" class="navbar-brand">
Yuncheng Liu's Blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="https://yuncliu.github.io/category/cs.html">Cs</a>
                        </li>
                        <li >
                            <a href="https://yuncliu.github.io/category/mathematics.html">Mathematics</a>
                        </li>
                        <li class="active">
                            <a href="https://yuncliu.github.io/category/network.html">Network</a>
                        </li>
                        <li >
                            <a href="https://yuncliu.github.io/category/programming.html">Programming</a>
                        </li>
                        <li >
                            <a href="https://yuncliu.github.io/category/tool.html">Tool</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://yuncliu.github.io/tcp-seq-and-ack.html"
                       rel="bookmark"
                       title="Permalink to TCP Seq and Ack">
                        TCP Seq and Ack
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-09-23T16:01:38+08:00"> Wed 23 September 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://yuncliu.github.io/tag/network.html">network</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><strong>Sequence</strong> and <strong>Acknowlegement</strong> number is very import in TCP protocol. 
They are used to detect if the packet is out of order or if there are any missing pakcets.
The <strong>Seq</strong> in the <strong>SYN</strong> packet is called <strong>ISN</strong>(Initial Sequence Number)</p>
<p>Wireshark will calculate relative sequence nuber = real Seq - ISN</p>
<div class="highlight"><pre><span></span>1.  <span class="m">36724</span> &gt; <span class="m">9999</span>  <span class="o">[</span>SYN<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">0</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43690</span> <span class="nv">Len</span><span class="o">=</span>0
    <span class="m">36724</span> send a TCP header with SYN flag to 9999, <span class="nv">ISN</span> <span class="o">=</span> 0. try to establish a TCP connection

2.  <span class="m">9999</span>  &gt; <span class="m">36724</span> <span class="o">[</span>SYN, ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">0</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">1</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43690</span> <span class="nv">Len</span><span class="o">=</span>0
    <span class="m">9999</span> reply with SYN flag and <span class="nv">Seq</span> <span class="o">=</span> ISN,  <span class="nv">Ack</span> <span class="o">=</span> <span class="o">(</span>ISN + 1<span class="o">)</span>

3.  <span class="m">36724</span> &gt; <span class="m">9999</span>  <span class="o">[</span>ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">1</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>0
    <span class="m">36724</span> send with  <span class="nv">Seq</span> <span class="o">=</span> ISN + 1, <span class="nv">Ack</span> <span class="o">=</span> ISN + 1.  
    TCP connection is estableshed 

4.  <span class="m">36724</span> &gt; <span class="m">9999</span>  <span class="o">[</span>PSH, ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">1</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>3
    <span class="nv">Seq</span> <span class="o">=</span> <span class="nv">ISN</span>  <span class="o">=</span> 1
    <span class="nv">Ack</span> <span class="o">=</span> Packet<span class="o">(</span>3<span class="o">)</span>.Ack <span class="o">=</span> 1

5.  <span class="m">9999</span>  &gt; <span class="m">36724</span> <span class="o">[</span>ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">4</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>0
    <span class="nv">Seq</span> <span class="o">=</span> <span class="nv">ISN</span>  <span class="o">=</span> 1
    <span class="nv">Ack</span> <span class="o">=</span> Packet<span class="o">(</span>4<span class="o">)</span>.Seq + Packet<span class="o">(</span>4<span class="o">)</span>.Len <span class="o">=</span> <span class="m">1</span> + <span class="nv">3</span> <span class="o">=</span> 4

6.  <span class="m">9999</span>  &gt; <span class="m">36724</span> <span class="o">[</span>PSH, ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">4</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>3
    <span class="nv">Seq</span> <span class="o">=</span> Packet<span class="o">(</span>5<span class="o">)</span>.Seq + Packet<span class="o">(</span>5<span class="o">)</span>.Len <span class="o">=</span> <span class="m">1</span> + <span class="nv">0</span> <span class="o">=</span> <span class="m">1</span>          Packet<span class="o">(</span>5<span class="o">)</span> is last packet sent from <span class="m">9999</span> to 36724
    <span class="nv">Ack</span> <span class="o">=</span> Packet<span class="o">(</span>5<span class="o">)</span>.Ack <span class="o">=</span> Packet<span class="o">(</span>4<span class="o">)</span>.Seq + Packet<span class="o">(</span>4<span class="o">)</span>.Len <span class="o">=</span> <span class="m">4</span>  Packet<span class="o">(</span>4<span class="o">)</span> is latest packet received from 36724

7.  <span class="m">36724</span> &gt; <span class="m">9999</span>  <span class="o">[</span>ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">4</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>0
    <span class="nv">Seq</span> <span class="o">=</span> Packet<span class="o">(</span>4<span class="o">)</span>.Seq + Packet<span class="o">(</span>4<span class="o">)</span>.Len <span class="o">=</span> <span class="m">1</span> + <span class="nv">3</span> <span class="o">=</span> <span class="m">4</span>    Packet<span class="o">(</span>4<span class="o">)</span> is last packet sent from <span class="m">36723</span> to 9999
    <span class="nv">Ack</span> <span class="o">=</span> Packet<span class="o">(</span>6<span class="o">)</span>.Seq + Packet<span class="o">(</span>6<span class="o">)</span>.Len <span class="o">=</span> <span class="m">1</span> + <span class="nv">3</span> <span class="o">=</span> 4

8.  <span class="m">36724</span> &gt; <span class="m">9999</span>  <span class="o">[</span>PSH, ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">Ack</span><span class="o">=</span><span class="m">4</span> <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>4
    <span class="nv">Seq</span> <span class="o">=</span> Packet<span class="o">(</span>7<span class="o">)</span>.Seq + Packet<span class="o">(</span>7<span class="o">)</span>.Len <span class="o">=</span> <span class="m">4</span> + <span class="nv">0</span> <span class="o">=</span> <span class="m">4</span>                   Packet<span class="o">(</span>7<span class="o">)</span> is last packet sent from <span class="m">36724</span> to 9999
    <span class="nv">Ack</span> <span class="o">=</span> Packet<span class="o">(</span>7<span class="o">)</span>.Ack <span class="o">=</span> Packet<span class="o">(</span>6<span class="o">)</span>.Seq + Packet<span class="o">(</span>6<span class="o">)</span>.Len <span class="o">=</span> <span class="m">1</span> + <span class="nv">3</span> <span class="o">=</span> <span class="m">4</span>   Packet<span class="o">(</span>6<span class="o">)</span> is latest packet received from 9999

9.  <span class="m">9999</span>  &gt; <span class="m">36724</span> <span class="o">[</span>PSH, ACK<span class="o">]</span> <span class="nv">Seq</span><span class="o">=</span>? <span class="nv">Ack</span><span class="o">=</span>? <span class="nv">Win</span><span class="o">=</span><span class="m">43776</span> <span class="nv">Len</span><span class="o">=</span>4
    So <span class="k">do</span> you know here the Seq and Ack ?
    Seq is related with packet <span class="m">6</span> and Ack is related with pakcet 8
</pre></div>


<p>So, the <strong>relative Seq</strong> can reflect how many bytes is already sent, and <strong>relative Ack</strong> could reflect 
how many bytes is already received.</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">



            <li class="list-group-item"><a href="https://yuncliu.github.io/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group " id="tags">
                    <li class="list-group-item tag-1">
                        <a href="https://yuncliu.github.io/tag/probability.html">
                            probability
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="https://yuncliu.github.io/tag/network.html">
                            network
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/linux.html">
                            linux
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/python.html">
                            python
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/git.html">
                            git
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/data-structure.html">
                            Data Structure
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/svn.html">
                            svn
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/ml.html">
                            ML
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/c.html">
                            C
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://yuncliu.github.io/tag/latex.html">
                            latex
                        </a>
                    </li>
                </ul>
            </li>


    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 yuncliu
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://yuncliu.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://yuncliu.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://yuncliu.github.io/theme/js/respond.min.js"></script>


</body>
</html>